To serve a machine learning model using FastAPI by developing a /predict REST endpoint with
input validation, writing test cases, containerizing the service, and verifying predictions through
Postman or curl.

sudo apt update
sudo apt install python3-full -y
python3 -m venv venv
source venv/bin/activate

mkdir q10
cd q10
pip install fastapi uvicorn scikit-learn joblib pytest
pip list

gedit train.py  :
from sklearn.linear_model import LinearRegression
import joblib
model=LinearRegression()
X=[[1],[2],[3]]
y=[2,4,6]
model.fit(X,y)
joblib.dump(model,"model.pkl")

python3 train.py
ls

gedit main.py  :
from fastapi import FastAPI
from pydantic import BaseModel
import joblib
app=FastAPI()
model=joblib.load("model.pkl")
class Input(BaseModel):
        x:float
@app.post("/predict")
def predict(data:Input):
        return{"prediction":model.predict([[data.x]])[0]}

uvicorn main:app --reload
new terminal:curl -X POST http://127.0.0.1:8000/predict -H "Content-Type:application/json" -d '{"x":6}'

gedit test_api.py :
from fastapi.testclient import TestClient
from main import app
client=TestClient(app)
def test_predict():
        result=client.post("/predict",json={"x":6})
        assert result.status_code==200

pip install httpx
pytest


gedit Dockerfile :
FROM python:3.11
WORKDIR /app
COPY . .
RUN pip install -r requirements.txt
CMD ["uvicorn","main:app","--host","0.0.0.0","--port","8000"]

pip freeze>requirements.txt
ls
docker build -t ml-api .
docker run -p 8000:8000 ml-api
new terminal:curl -X POST http://0.0.0.0:8000/predict -H "Content-Type:application/json" -d '{"x":9}'




























